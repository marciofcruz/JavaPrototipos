<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-br" xml:lang="pt-br"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/template.xhtml">
	<ui:define name="corpo">

		<p:growl id="growl" life="3000" />

		<h:form id="form-ocorrencia" style="margin-bottom: 20px">

			<p:wizard flowListener="#{ocorrenciaBean.onFlowProcess}"
				showNavBar="false" showStepStatus="true" widgetVar="wizard">

				<p:tab id="ocorrencia" title="Ocorrência">
					<p:panel header="Detalhes da ocorrência">

						<h:panelGrid columns="3" columnClasses="label, value, message">
							<p:outputLabel value="Nome:" for="nome" />
							<p:inputText id="nome" value="#{ocorrenciaBean.ocorrencia.nome}"
								style="width: 100%" required="true"
								placeholder="Qual o título da ocorrência?"
								requiredMessage="Nome obrigatório!" />
							<p:message for="nome" />

							<p:outputLabel value="Descrição:" for="descricao" />
							<p:inputTextarea id="descricao" rows="3" cols="25"
								value="#{ocorrenciaBean.ocorrencia.descricao}"
								style="width: 100%" required="true"
								placeholder="Qual a descrição da ocorrência?"
								requiredMessage="Descrição obrigatória!" />
							<p:message for="descricao" />

						</h:panelGrid>
					</p:panel>
				</p:tab>

				<p:tab id="problema" title="Problema">
					<p:panel header="Detalhes do problema">
						<h:panelGrid columns="3" columnClasses="label, value, message">
							<p:outputLabel value="Nome:" for="problema-nome" />
							<p:inputText id="problema-nome"
								value="#{ocorrenciaBean.problema.nome}" style="width: 100%"
								required="true" placeholder="Qual o título do problema?"
								requiredMessage="Nome obrigatório!" />
							<p:message for="problema-nome" />

							<p:outputLabel value="Descrição:" for="problema-descricao" />
							<p:inputTextarea id="problema-descricao" rows="3" cols="25"
								value="#{ocorrenciaBean.problema.descricao}" style="width: 100%"
								required="true" placeholder="Qual a descrição do problema?"
								requiredMessage="Descrição obrigatória!" />
							<p:message for="problema-descricao" />

						</h:panelGrid>
					</p:panel>
				</p:tab>

				<p:tab id="contato" title="Contato">
					<p:panel header="Dados do Contato">
						<h:panelGrid columns="3" cellpadding="5"
							columnClasses="label, value, message">

							<p:outputLabel value="Telefone:" for="telefone" />
							<p:inputMask id="telefone"
								value="#{ocorrenciaBean.contato.telefone}" style="width: 100%"
								required="true" placeholder="Qual o seu telefone?"
								mask="(99) 9999-9999" requiredMessage="Telefone obrigatório!">
							</p:inputMask>
							<p:message for="telefone" />

							<p:outputLabel value="Celular:" for="celular" />
							<p:inputMask id="celular"
								value="#{ocorrenciaBean.contato.celular}" style="width: 100%"
								required="true" placeholder="Qual o seu celular?"
								mask="(99) 9999-9999?9" requiredMessage="Celular obrigatório!">
							</p:inputMask>
							<p:message for="celular" />

							<p:outputLabel value="Email:" for="email" />
							<p:inputText id="email" value="#{ocorrenciaBean.contato.email}"
								style="width: 100%" required="true"
								placeholder="Qual o seu email?"
								requiredMessage="Email obrigatório!">
							</p:inputText>
							<p:message for="email" />

						</h:panelGrid>
					</p:panel>
				</p:tab>

				<p:tab id="endereco" title="Endereço">
					<p:panel header="Dados do Endereço">
						<h:panelGrid columns="3" cellpadding="5"
							columnClasses="label, value, message">

							<p:outputLabel value="País:" for="pais" />
							<p:selectOneMenu id="pais" rendered="true" required="true"
								requiredMessage="País obrigatório!"
								value="#{ocorrenciaBean.endereco.pais.id}" effect="fade"
								editable="false">
								<f:validateLength for="pais" minimum="1" />
								<f:selectItem itemValue="" itemLabel="Selecione.." />
								<f:selectItems value="#{paisBean.paises}" var="p"
									itemValue="#{p.id}" itemLabel="#{p.nome}" />
							</p:selectOneMenu>
							<p:message for="pais" />

							<p:outputLabel value="Estado:" for="estado" />
							<p:selectOneMenu id="estado" rendered="true" required="true"
								requiredMessage="Estado obrigatório!"
								value="#{ocorrenciaBean.endereco.estado.id}" effect="fade"
								editable="false">
								<f:validateLength for="estado" minimum="1" />
								<f:selectItem itemValue="" itemLabel="Selecione.." />
								<f:selectItems value="#{estadoBean.estados}" var="e"
									itemValue="#{e.id}" itemLabel="#{e.nome}" />
							</p:selectOneMenu>
							<p:message for="estado" />

							<p:outputLabel value="Cidade:" for="cidade" />
							<p:selectOneMenu id="cidade" rendered="true" required="true"
								requiredMessage="Cidade obrigatória!"
								value="#{ocorrenciaBean.endereco.cidade.id}" effect="fade"
								editable="false">
								<f:validateLength for="cidade" minimum="1" />
								<f:selectItem itemValue="" itemLabel="Selecione.." />
								<f:selectItems value="#{cidadeBean.cidades}" var="c"
									itemValue="#{c.id}" itemLabel="#{c.nome}" />
							</p:selectOneMenu>
							<p:message for="cidade" />

							<p:outputLabel value="Bairro:" for="bairro" />
							<p:selectOneMenu id="bairro" rendered="true" required="true"
								requiredMessage="Bairro obrigatório!"
								value="#{ocorrenciaBean.endereco.bairro.id}" effect="fade"
								editable="false">
								<f:validateLength for="bairro" minimum="1" />
								<f:selectItem itemValue="" itemLabel="Selecione.." />
								<f:selectItems value="#{bairroBean.bairros}" var="b"
									itemValue="#{b.id}" itemLabel="#{b.nome}" />
							</p:selectOneMenu>
							<p:message for="bairro" />

							<p:outputLabel value="Logradouro:" for="logradouro" />
							<p:inputText id="logradouro"
								value="#{ocorrenciaBean.endereco.logradouro.nome}"
								style="width: 100%" required="true"
								placeholder="Qual o seu logradouro?"
								requiredMessage="Descrição obrigatória!" />
							<p:message for="logradouro" />

							<p:outputLabel value="Tipo:" for="tipo" />
							<p:inputText id="tipo"
								value="#{ocorrenciaBean.endereco.logradouro.tipo}"
								style="width: 100%" required="true"
								placeholder="Qual o tipo do logradouro?"
								requiredMessage="Tipo obrigatório!" />
							<p:message for="tipo" />

						</h:panelGrid>
					</p:panel>
				</p:tab>

				<p:tab id="confirmacao" title="Confirmação">
					<p:panel header="Formulário Completo">

						<h:panelGrid id="confirmation" columns="3"
							columnClasses="grid,grid" style="width: 100%">
							<h:panelGrid columns="2" columnClasses="label, value">
								<h:outputText value="Ocorrência: " />
								<h:outputText value="#{ocorrenciaBean.ocorrencia.nome}"
									styleClass="outputLabel" />

								<h:outputText value="Descrição: " />
								<h:outputText value="#{ocorrenciaBean.ocorrencia.descricao}"
									styleClass="outputLabel" />
							</h:panelGrid>

							<h:panelGrid columns="2" columnClasses="label, value">
								<h:outputText value="Problema: " />
								<h:outputText value="#{ocorrenciaBean.problema.nome}"
									styleClass="outputLabel" />

								<h:outputText value="Descrição: " />
								<h:outputText value="#{ocorrenciaBean.problema.descricao}"
									styleClass="outputLabel" />
							</h:panelGrid>

							<h:panelGrid columns="2" columnClasses="label, value">
								<h:outputText value="Telefone: " />
								<h:outputText value="#{ocorrenciaBean.contato.telefone}"
									styleClass="outputLabel" />

								<h:outputText value="Celular: " />
								<h:outputText value="#{ocorrenciaBean.contato.celular}"
									styleClass="outputLabel" />

								<h:outputText value="Email: " />
								<h:outputText value="#{ocorrenciaBean.contato.email}"
									styleClass="outputLabel" />
							</h:panelGrid>
						</h:panelGrid>

						<p:commandButton value="Enviar" ajax="false"
							actionListener="#{ocorrenciaBean.gravaTudo}" update="growl"
							process="@this" />
					</p:panel>
				</p:tab>

			</p:wizard>

			<div class="ui-wizard-navbar ui-helper-clearfix">

				<p:commandButton type="button" value="Voltar" iconPos="left"
					class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-left ui-wizard-nav-back"
					icon="ui-icon-arrow-1-w" onclick="PF('wizard').back()" />

				<p:commandButton type="button" value="Próximo" iconPos="right"
					class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-left ui-wizard-nav-next"
					icon="ui-icon-arrow-1-e" onclick="PF('wizard').next()" />

			</div>

		</h:form>

		<h:form id="form-ocorrencias">

			<p:panel id="painel-ocorrencias" header="Listagem de ocorrências"
				rendered="#{ocorrenciaBean.ocorrencias.size() > 0}"
				toggleable="true" style="margin-bottom:10px">

				<p:dataTable id="tabela-ocorrencias" var="ocorrencia"
					value="#{ocorrenciaBean.ocorrencias}">
					<p:column headerText="Ocorrência">
						<h:outputText value="#{ocorrencia.nome}"
							sortBy="#{ocorrencia.nome}" />
					</p:column>

					<p:column headerText="Data" priority="2">
						<h:outputText value="#{ocorrencia.dataCriacaoDate}"
							sortBy="#{ocorrencia.dataCriacao}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<p:column>
						<p:commandLink action="#{ocorrenciaBean.removeTudo(ocorrencia)}"
							immediate="true" update="@form,growl" process="@form">
							<h:graphicImage library="imagens" name="delete.png"
								title="remover" style="border:0" />
						</p:commandLink>
					</p:column>

				</p:dataTable>

			</p:panel>
		</h:form>

	</ui:define>
</ui:composition>
</html>